clear, close all

%%	Paths
PATHS.Root = '~/Haemodynamic_Tools/Version6/';


%%	t, Q, P data from Study1, Aortic Coarctation
P = [6895.96326588800;6895.82994357600;6896.09658820000;6897.02984438400;6898.49638981600;6900.89619143200;6903.96260460800;6907.96227396800;6913.02852182400;6919.16134817600;6926.62739764800;6935.29334792800;6945.42584364000;6957.15820709600;6970.49043829600;6985.68918186400;7002.62111548800;7021.41956148000;7042.21784215200;7065.14927981600;7089.94722984800;7116.87833687200;7145.94260088800;7177.14002189600;7210.47059989600;7245.93433488800;7283.66454918400;7323.39459816000;7365.25780412800;7409.25416708800;7455.25036472800;7503.24639704800;7553.24226404800;7605.23796572800;7658.96685746400;7714.56226156800;7771.89085572800;7830.81931763200;7891.21432496800;7953.07587773600;8016.13733131200;8080.13204107200;8144.92668470400;8210.12129527200;8275.84919508800;8341.57709490400;8407.57163934400;8473.43286147200;8539.29408360000;8605.42195035200;8671.94978404000;8738.87758466400;8806.33867453600;8874.73302059200;8944.06062283200;9014.32148125600;9085.64891817600;9157.90961128000;9231.10356056800;9305.09744372800;9379.75793844800;9455.21836704000;9531.21208488000;9607.87241428000;9684.93271061600;9762.52629620000;9840.51984872000;9918.64672355200;9997.04024300800;10075.1671178400;10153.1606703600;10230.4876113200;10307.2812630320;10383.1416585600;10457.8021532800;10531.2627471920;10603.5234402960;10674.1842656560;10743.3785455840;10810.9729577680;10876.8341798960;10940.8288896560;11003.2237316720;11063.6187390080;11122.1472339760;11178.8092165760;11233.7380091200;11286.6669669840;11337.9960571040;11387.5919571680;11435.4546671760;11481.8508317520;11526.7804508960;11570.2435246080;11612.2400528880;11653.0366803600;11692.5000847120;11730.4969436320;11767.2939017440;11802.4909921120;11836.3548593600;11868.6188588640;11899.4163129360;11928.4805769520;11955.8116509120;11981.4095348160;12005.0075840400;12026.6057985840;12046.0708561360;12063.5360790080;12078.6015002640;12091.4004422160;12101.7995825520;12109.7989212720;12115.2651360640;12118.0649046160;12118.3315492400;12115.9317476240;12110.8654997680;12102.9994833600;12092.6003430240;12079.6680787600;12064.2026905680;12046.4708230720;12026.7391208960;12005.1409063520;11982.0761463760;11957.8114855920;11932.7468909360;11907.1490070320;11881.5511231280;11855.9532392240;11830.7553222560;11806.0906945360;11781.8260337520;11758.3613068400;11735.2965468640;11713.0317207600;11691.1668615920;11670.1019362960;11649.5703002480;11629.7052757600;11610.6401851440;11592.3750284000;11574.7764832160;11557.9778719040;11541.7125498400;11526.1138393360;11511.0484180800;11496.3829637600;11482.1174763760;11468.1186336160;11454.5197577920;11441.0542042800;11427.9886177040;11415.0563534400;11402.5240561120;11390.3917257200;11378.6593622640;11367.3269657440;11356.3945361600;11345.9953958240;11336.2628670480;11327.0636275200;11318.5309995520;11310.7983054560;11303.9988675440;11297.9993635040;11293.1997602720;11289.4667355360;11286.8002892960;11285.3337438640;11284.9337769280;11285.6003884880;11287.2002562320;11289.8667024720;11293.1997602720;11297.4660742560;11302.2656774880;11307.7318922800;11313.7313963200;11319.9975449840;11326.7969828960;11333.8630654320;11341.3291149040;11348.9284866880;11356.6611807840;11364.6605195040;11372.7931805360;11380.9258415680;11389.1918249120;11397.3244859440;11405.5904692880;11413.5898080080;11421.4558244160;11429.1885185120;11436.7878902960;11444.1206174560;11451.1866999920;11458.2527825280;11465.1855427520;11471.9849806640;11478.6510962640;11485.3172118640;11491.8500051520;11498.2494761280;11504.6489471040;11510.7817734560;11516.9145998080;11522.9141038480;11528.7802855760;11534.5131449920;11540.2460044080;11545.9788638240;11551.5784009280;11557.0446157200;11562.3775082000;11567.7104006800;11572.7766485360;11577.5762517680;11582.2425326880;11586.6421689840;11590.7751606560;11594.6415077040;11598.2412101280;11601.5742679280;11604.7740034160;11607.5737719680;11610.2402182080;11612.5066975120;11614.6398545040;11616.3730445600;11617.9729123040;11619.3061354240;11620.3727139200;11621.1726477920;11621.8392593520;11622.3725486000;11622.7725155360;11623.0391601600;11623.3058047840;11623.3058047840;11623.3058047840;11623.1724824720;11622.9058378480;11622.5058709120;11621.9725816640;11621.1726477920;11620.3727139200;11619.3061354240;11617.9729123040;11616.3730445600;11614.5065321920;11612.2400528880;11609.7069289600;11606.7738380960;11603.4407802960;11599.7077555600;11595.5747638880;11591.0418052800;11586.1088797360;11580.7759872560;11575.0431278400;11568.9103014880;11562.5108305120;11555.5780702880;11548.3786654400;11540.9126159680;11532.9132772480;11524.7806162160;11516.2479882480;11507.3153933440;11498.1161538160;11488.5169473520;11478.5177739520;11468.2519559280;11457.7194932800;11446.9203860080;11435.7213118000;11424.3889152800;11412.6565518240;11400.5242214320;11388.2585687280;11375.4596267760;11362.3940402000;11348.9284866880;11334.9296439280;11320.5308342320;11305.7320576000;11290.3999917200;11274.5346365920;11258.1359922160;11241.2040585920;11223.7388357200;11205.6070012880;11186.9418776080;11167.4768200560;11147.3451509440;11126.5468702720;11104.9486557280;11082.4171850000;11059.2191027120;11035.2210865520;11010.4231365200;10984.6919303040;10958.2941125280;10930.9630385680;10902.8320307360;10873.7677667200;10843.7702465200;10812.8394701360;10781.1087598800;10748.5781157520;10715.2475377520;10681.2503481920;10646.5865470720;10611.2561343920;10575.2591101520;10538.7287966640;10501.6651939280;10463.8016573200;10425.4048314640;10386.4747163600;10346.8779896960;10306.6146514720;10265.9513463120;10224.6214295920;10183.0248682480;10141.0283399680;10098.7651670640;10056.2353495360;10013.7055320080;9971.04239216800;9928.37925232800;9885.84943480000;9843.31961727200;9801.05644436800;9759.05991608800;9717.46335474400;9676.26676033600;9635.47013286400;9595.47343926400;9556.01003491200;9517.34656443200;9479.61635013600;9442.68606971200;9406.82236778400;9372.02524435200;9338.42802172800;9305.89737760000;9274.69995659200;9244.70243639200;9215.90481700000;9188.57374304000;9162.70921451200;9138.17790910400;9115.11314912800;9093.51493458400;9073.38326547200;9054.85146410400;9037.65288585600;9022.18749766400;9008.18865490400;8995.65635757600;8984.72392799200;8975.25804384000;8967.39202743200;8960.85923414400;8955.79298628800;8952.19328386400;8949.79348224800;8948.86022606400;8948.99354837600;8950.46009380800;8952.85989542400;8956.45959784800;8960.85923414400;8966.32544893600;8972.59159760000;8979.65768013600;8987.52369654400;8996.05632451200;9005.38888635200;9015.25473744000;9025.65387777600;9036.45298504800;9047.78538156800;9059.38442271200;9071.25010848000;9083.24911656000;9095.38144695200;9107.64709965600;9119.91275236000;9132.31172737600;9144.57738008000;9156.84303278400;9168.84204086400;9180.70772663200;9192.44009008800;9203.63916429600;9214.43827156800;9224.83741190400;9234.70326299200;9243.90250252000;9252.70177511200;9260.83443614400;9268.43380792800;9275.49989046400;9281.89936144000;9287.76554316800;9292.96511333600;9297.63139425600;9301.76438592800;9305.23076604000;9308.16385690400;9310.43033620800;9312.16352626400;9313.36342707200;9313.89671632000;9313.89671632000;9313.36342707200;9312.16352626400;9310.56365852000;9308.43050152800;9305.76405528800;9302.56431980000;9298.83129506400;9294.56498108000;9289.76537784800;9284.56580768000;9278.96627057600;9272.83344422400;9266.30065093600;9259.36789071200;9252.16848586400;9244.56911408000;9236.70309767200;9228.43711432800;9219.90448636000;9210.97189145600;9201.90597424000;9192.57341240000;9182.84088362400;9172.97503253600;9162.84253682400;9152.57671880000;9142.04425615200;9131.37847119200;9120.57936392000;9109.64693433600;9098.71450475200;9087.78207516800;9076.71632327200;9065.65057137600;9054.58481948000;9043.51906758400;9032.45331568800;9021.38756379200;9010.32181189600;8999.25606000000;8988.19030810400;8977.25787852000;8966.32544893600;8955.52634166400;8944.72723439200;8934.06144943200;8923.39566447200;8912.86320182400;8902.33073917600;8891.79827652800;8881.39913619200;8871.13331816800;8860.73417783200;8850.46835980800;8840.20254178400;8830.07004607200;8819.93755036000;8809.93837696000;8799.93920356000;8789.80670784800;8779.94085676000;8769.94168336000;8759.94250996000;8750.07665887200;8740.21080778400;8730.34495669600;8720.61242792000;8710.74657683200;8701.14737036800;8691.41484159200;8681.81563512800;8672.21642866400;8662.75054451200;8653.28466036000;8643.95209852000;8634.61953668000;8625.28697484000;8616.08773531200;8607.02181809600;8597.82257856800;8588.75666135200;8579.69074413600;8570.62482692000;8561.69223201600;8552.75963711200;8543.82704220800;8535.02776961600;8526.22849702400;8517.42922443200;8508.76327415200;8500.09732387200;8491.43137359200;8482.89874562400;8474.36611765600;8465.83348968800;8457.43418403200;8449.03487837600;8440.76889503200;8432.50291168800;8424.23692834400;8416.10426731200;8407.97160628000;8399.83894524800;8391.83960652800;8383.84026780800;8375.97425140000;8368.10823499200;8360.37554089600;8352.64284680000;8345.17679732800;8337.71074785600;8330.37802069600;8323.17861584800;8315.97921100000;8308.91312846400;8301.84704592800;8294.91428570400;8288.11484779200;8281.44873219200;8274.91593890400;8268.64979024000;8262.38364157600;8256.25081522400;8250.38463349600;8244.51845176800;8238.91891466400;8233.45269987200;8227.98648508000;8222.78691491200;8217.58734474400;8212.52109688800;8207.72149365600;8202.92189042400;8198.38893181600;8193.98929552000;8189.58965922400;8185.45666755200;8181.32367588000;8177.45732883200;8173.59098178400;8169.85795704800;8166.25825462400;8162.79187451200;8159.32549440000;8155.99243660000;8152.79270111200;8149.72628793600;8146.65987476000;8143.86010620800;8141.06033765600;8138.26056910400;8135.72744517600;8133.06099893600;8130.66119732000;8128.26139570400;8125.99491640000;8123.86175940800;8121.72860241600;8119.59544542400;8117.59561074400;8115.72909837600;8113.86258600800;8112.12939595200;8110.39620589600;8108.66301584000;8107.06314809600;8105.32995804000;8103.73009029600;8102.26354486400;8100.66367712000;8099.19713168800;8097.59726394400;8096.13071851200;8094.66417308000;8093.06430533600;8091.59775990400;8090.13121447200;8088.66466904000;8087.19812360800;8085.73157817600;8084.13171043200;8082.53184268800;8081.06529725600;8079.33210720000;8077.73223945600;8075.99904940000;8074.26585934400;8072.39934697600;8070.53283460800;8068.79964455200;8066.93313218400;8064.93329750400;8062.93346282400;8060.80030583200;8058.66714884000;8056.40066953600;8054.13419023200;8051.86771092800;8049.46790931200;8047.20143000800;8044.66830608000;8042.26850446400;8039.73538053600;8037.06893429600;8034.40248805600;8031.73604181600;8028.93627326400;8026.13650471200;8023.20341384800;8020.27032298400;8017.20390980800;8014.13749663200;8011.07108345600;8008.00467028000;8004.80493479200;8001.60519930400;7998.40546381600;7995.07240601600;7991.60602590400;7988.27296810400;7984.80658799200;7981.20688556800;7977.74050545600;7974.14080303200;7970.40777829600;7966.80807587200;7963.07505113600;7959.34202640000;7955.60900166400;7951.87597692800;7948.00962988000;7944.14328283200;7940.14361347200;7936.14394411200;7932.14427475200;7928.01128308000;7923.87829140800;7919.61197742400;7915.47898575200;7911.21267176800;7906.94635778400;7902.68004380000;7898.41372981600;7894.14741583200;7889.88110184800;7885.48146555200;7881.08182925600;7876.68219296000;7872.28255666400;7867.74959805600;7863.34996176000;7858.95032546400;7854.55068916800;7850.01773056000;7845.75141657600;7841.35178028000;7836.95214398400;7832.55250768800;7828.28619370400;7823.88655740800;7819.48692111200;7815.08728481600;7810.82097083200;7806.55465684800;7802.15502055200;7797.88870656800;7793.62239258400;7789.35607860000;7785.08976461600;7780.95677294400;7776.69045896000;7772.42414497600;7768.29115330400;7764.02483932000;7759.75852533600;7755.49221135200;7751.35921968000;7747.22622800800;7743.09323633600;7738.96024466400;7734.82725299200;7730.69426132000;7726.69459196000;7722.56160028800;7718.56193092800;7714.42893925600;7710.42926989600;7706.42960053600;7702.42993117600;7698.43026181600;7694.43059245600;7690.43092309600;7686.56457604800;7682.69822900000;7678.83188195200;7674.96553490400;7671.09918785600;7667.36616312000;7663.63313838400;7659.90011364800;7656.16708891200;7652.43406417600;7648.70103944000;7645.10133701600;7641.50163459200;7637.90193216800;7634.30222974400;7630.70252732000;7627.10282489600;7623.63644478400;7620.03674236000;7616.43703993600;7612.83733751200;7609.37095740000;7605.77125497600;7602.30487486400;7598.70517244000;7595.23879232800;7591.77241221600;7588.30603210400;7584.83965199200;7581.50659419200;7578.04021408000;7574.70715628000;7571.24077616800;7567.77439605600;7564.30801594400;7560.84163583200;7557.50857803200;7554.04219792000;7550.70914012000;7547.24276000800;7543.90970220800;7540.57664440800;7537.37690892000;7534.04385112000;7530.84411563200;7527.64438014400;7524.44464465600;7521.24490916800;7518.04517368000;7514.71211588000;7511.51238039200;7508.44596721600;7505.24623172800;7502.04649624000;7498.98008306400;7495.91366988800;7492.71393440000;7489.64752122400;7486.58110804800;7483.38137256000;7480.31495938400;7477.24854620800;7474.04881072000;7470.98239754400;7467.91598436800;7464.71624888000;7461.64983570400;7458.58342252800;7455.38368704000;7452.31727386400;7449.25086068800;7446.18444751200;7442.98471202400;7439.91829884800;7436.85188567200;7433.78547249600;7430.71905932000;7427.65264614400;7424.58623296800;7421.51981979200;7418.58672892800;7415.52031575200;7412.58722488800;7409.65413402400;7406.85436547200;7403.92127460800;7400.98818374400;7398.18841519200;7395.25532432800;7392.45555577600;7389.65578722400;7386.85601867200;7384.05625012000;7381.25648156800;7378.59003532800;7375.79026677600;7373.12382053600;7370.45737429600;7367.65760574400;7364.99115950400;7362.19139095200;7359.39162240000;7356.72517616000;7354.05872992000;7351.39228368000;7348.85915975200;7346.19271351200;7343.65958958400;7341.12646565600;7338.46001941600;7335.92689548800;7333.52709387200;7330.99396994400;7328.46084601600;7325.92772208800;7323.39459816000;7320.86147423200;7318.46167261600;7315.92854868800;7313.52874707200;7311.26226776800;7308.86246615200;7306.59598684800;7304.46282985600;7302.19635055200;7300.06319356000;7297.93003656800;7295.66355726400;7293.53040027200;7291.39724328000;7289.39740860000;7287.26425160800;7285.26441692800;7283.26458224800;7281.39806988000;7279.53155751200;7277.53172283200;7275.66521046400;7273.66537578400;7271.66554110400;7269.66570642400;7267.79919405600;7265.79935937600;7263.79952469600;7261.79969001600;7259.66653302400;7257.66669834400;7255.53354135200;7253.53370667200;7251.26722736800;7249.13407037600;7246.86759107200;7244.60111176800;7242.20131015200;7239.80150853600;7237.40170692000;7235.00190530400;7232.46878137600;7229.93565744800;7227.26921120800;7224.60276496800;7221.93631872800;7219.26987248800;7216.47010393600;7213.67033538400;7210.73724452000;7207.80415365600;7204.87106279200;7201.80464961600;7198.73823644000;7195.53850095200;7192.33876546400;7189.13902997600;7185.93929448800;7182.60623668800;7179.27317888800;7175.80679877600;7172.34041866400;7168.87403855200;7165.40765844000;7161.80795601600;7158.07493128000;7154.47522885600;7150.87552643200;7147.27582400800;7143.80944389600;7140.20974147200;7136.61003904800;7133.01033662400;7129.41063420000;7125.81093177600;7122.21122935200;7118.74484924000;7115.14514681600;7111.67876670400;7108.21238659200;7104.74600648000;7101.41294868000;7098.07989088000;7094.88015539200;7091.68041990400;7088.48068441600;7085.28094892800;7082.21453575200;7079.01480026400;7075.94838708800;7072.88197391200;7069.81556073600;7066.61582524800;7063.54941207200;7060.48299889600;7057.28326340800;7054.08352792000;7051.01711474400;7047.81737925600;7044.48432145600;7041.15126365600;7037.81820585600;7034.35182574400;7030.75212332000;7027.15242089600;7023.55271847200;7019.81969373600;7016.08666900000;7012.22032195200;7008.48729721600;7004.62095016800;7000.75460312000;6996.88825607200;6992.88858671200;6989.02223966400;6985.02257030400;6981.02290094400;6977.15655389600;6973.15688453600;6969.29053748800;6965.42419044000;6961.55784339200;6957.69149634400;6953.82514929600;6950.09212456000;6946.22577751200;6942.62607508800;6939.02637266400;6935.42667024000;6931.82696781600;6928.49391001600;6925.02752990400];
Q = [0;3.10887455793635e-05;6.35792445540729e-05;9.76595782061525e-05;0.000131648858370059;0.000164128509194400;0.000193942267141931;0.000220196180989558;0.000242258611828338;0.000259760233063477;0.000270419039670788;0.000277682261792589;0.000281570494009961;0.000283513261158010;0.000284503510951291;0.000285119060823414;0.000284761464530892;0.000283655420264215;0.000282433464223218;0.000280097817818203;0.000276737653981501;0.000272994001115320;0.000268047673403457;0.000261908786031575;0.000254538945830048;0.000246998610849374;0.000238446949214468;0.000229273501144165;0.000219237890890910;0.000209238521239159;0.000199223068284522;0.000189906704997789;0.000180957440916870;0.000172084457435148;0.000164386331173202;0.000157896704036306;0.000151407758398554;0.000144985281233775;0.000139005323154433;0.000132110698228948;0.000124904383977847;0.000117451687787243;0.000109505333538450;0.000100549542910986;9.01723442878295e-05;7.89810380170375e-05;6.77356656346749e-05;5.60212156990943e-05;4.39846543468646e-05;3.33690798607773e-05;2.45000073072707e-05;1.79958317789358e-05;1.37880979943465e-05;1.12680264600119e-05;1.14432817337461e-05;1.31600873026556e-05;1.52702324865873e-05;1.74401499913466e-05;1.91624510124416e-05;2.01720319981540e-05;2.03990885141242e-05;1.93743614791454e-05;1.89139988077611e-05;1.95825894659923e-05;1.97164509739823e-05;2.01147549179855e-05;2.21144391669711e-05;2.41097102090264e-05;2.62841662980982e-05;2.87717120166144e-05;3.00920116147145e-05;2.98638620848797e-05;2.88051493183086e-05;2.73989127550334e-05;2.46577228236832e-05;2.03133973040017e-05;1.63417641289926e-05;1.37637117089399e-05;1.16084314366479e-05;1.02560698421245e-05;1.00564609734054e-05;1.03602842143722e-05;1.05001669134473e-05;1.13227917620137e-05;1.19664830875142e-05;1.19462715612561e-05;1.17975086052728e-05;1.03109382151030e-05;8.41696440589966e-06;6.80627886852681e-06;5.74092840797646e-06;5.48761840663039e-06;6.30134684537430e-06;6.64681729900198e-06;6.03289656365979e-06;4.57075707170740e-06;3.66633309616753e-06;3.96236870949753e-06;3.94288675653328e-06;3.67509066784608e-06;4.83579178124339e-06;5.49362844451282e-06;4.84104224756264e-06;4.49258273561141e-06;3.84575851393189e-06;3.37013133857662e-06;4.51298578928139e-06;4.27034901832587e-06;1.75426340788031e-06;-1.30137376689807e-06;-3.46444012845413e-06;-3.35397304001692e-06;-1.72286829605984e-06;-1.08493471530488e-06;-1.09875237967040e-06;-5.91386266176954e-07;-1.07860315751015e-07;1.01863815549103e-06;2.19511028209911e-06;2.43197277080169e-06;3.86623079437725e-06;4.12630502086418e-06;2.91620906486164e-06;1.86605888121839e-06;-2.46330019421955e-07;-1.67347191508182e-06;-1.22079418495087e-06;-1.85255658327404e-06;-4.10098032805800e-06;-5.83047247274196e-06;-6.08432744264754e-06;-4.70401669134473e-06;-2.24303444032075e-06;4.94375324500526e-08;6.08742572543892e-07;1.88232986558468e-06;1.92865719285426e-06;2.45190123646713e-06;3.82522200642271e-06;4.26967937164464e-06;4.33812101360897e-06;4.00460622221290e-06;3.26293828813683e-06;2.12666450284434e-06;6.29076158582147e-07;-1.17679145161983e-06;-3.21815903394851e-06;-5.40250329380764e-06;-7.61755693581780e-06;-7.61755693581780e-06];
t = [0;0.00661744966442953;0.0132348993288591;0.0198523489932886;0.0264697986577181;0.0330872483221477;0.0397046979865772;0.0463221476510067;0.0529395973154362;0.0595570469798658;0.0661744966442953;0.0727919463087248;0.0794093959731544;0.0860268456375839;0.0926442953020134;0.0992617449664430;0.105879194630872;0.112496644295302;0.119114093959732;0.125731543624161;0.132348993288591;0.138966442953020;0.145583892617450;0.152201342281879;0.158818791946309;0.165436241610738;0.172053691275168;0.178671140939597;0.185288590604027;0.191906040268456;0.198523489932886;0.205140939597315;0.211758389261745;0.218375838926175;0.224993288590604;0.231610738255034;0.238228187919463;0.244845637583893;0.251463087248322;0.258080536912752;0.264697986577181;0.271315436241611;0.277932885906040;0.284550335570470;0.291167785234899;0.297785234899329;0.304402684563758;0.311020134228188;0.317637583892618;0.324255033557047;0.330872483221477;0.337489932885906;0.344107382550336;0.350724832214765;0.357342281879195;0.363959731543624;0.370577181208054;0.377194630872483;0.383812080536913;0.390429530201342;0.397046979865772;0.403664429530201;0.410281879194631;0.416899328859060;0.423516778523490;0.430134228187919;0.436751677852349;0.443369127516779;0.449986577181208;0.456604026845638;0.463221476510067;0.469838926174497;0.476456375838926;0.483073825503356;0.489691275167785;0.496308724832215;0.502926174496644;0.509543624161074;0.516161073825503;0.522778523489933;0.529395973154362;0.536013422818792;0.542630872483222;0.549248322147651;0.555865771812081;0.562483221476510;0.569100671140940;0.575718120805369;0.582335570469799;0.588953020134228;0.595570469798658;0.602187919463087;0.608805369127517;0.615422818791946;0.622040268456376;0.628657718120805;0.635275167785235;0.641892617449664;0.648510067114094;0.655127516778524;0.661744966442953;0.668362416107383;0.674979865771812;0.681597315436242;0.688214765100671;0.694832214765101;0.701449664429530;0.708067114093960;0.714684563758389;0.721302013422819;0.727919463087248;0.734536912751678;0.741154362416107;0.747771812080537;0.754389261744967;0.761006711409396;0.767624161073826;0.774241610738255;0.780859060402685;0.787476510067114;0.794093959731544;0.800711409395973;0.807328859060403;0.813946308724832;0.820563758389262;0.827181208053691;0.833798657718121;0.840416107382550;0.847033557046980;0.853651006711409;0.860268456375839;0.866885906040268;0.873503355704698;0.880120805369128;0.886738255033557;0.893355704697987;0.899973154362416;0.906590604026846;0.913208053691275;0.919825503355705;0.926442953020134;0.933060402684564;0.939677852348993;0.946295302013423;0.952912751677852;0.959530201342282;0.966147651006711;0.972765100671141;0.979382550335570;0.986000000000000];

%	Same vector length required
addpath([PATHS.Root,'Others/InterpolateSpline/'])
[P,Q,t] = InterpolateSpline(t,P,Q);

DBP = min(P);
MBP = mean(P);
Q_mean = mean(Q);


%%	Decide range of parameters
P_out_base = [3.298060693100000e+03];
Z_0_base = [3.730530684494501e+06];
R_T_base = (MBP - P_out_base) / Q_mean;
R_2_base = R_T_base - Z_0_base;
C_T_base = [2.469575078992094e-08];
tau_base = R_2_base*C_T_base;

P_out = P_out_base*[0.25:0.25:2];
Z_0 = Z_0_base*[0.1:0.1:4];
R_T = R_T_base*[0.25:0.25:2];
C_T = C_T_base*[0.25:0.25:2];


%%	Iterate for each parameter while keeping others at baseline
figure, hold on, title('P_{out}')
plot(t,P,'k')
for j = 1:length(P_out)
	EST_temp.P_out = P_out(j);
	EST_temp.P_0 = DBP;
	EST_temp.R_T = R_T_base;
	EST_temp.Z_0 = Z_0_base;
	EST_temp.C_T = C_T_base;
	EST_temp.Q_in = Q;
	EST_temp.t_in = t;
		
	EST(j) = P_0_iteration(EST_temp,0,'Wk3');
	
	plot(t,EST(j).Pressure,'--')
end

figure, hold on, title('Z_0')
plot(t,P,'k')
for j = 1:length(Z_0)
	EST_temp.P_out = P_out_base;
	EST_temp.P_0 = DBP;
	EST_temp.R_T = R_T_base;
	EST_temp.Z_0 = Z_0(j);
	EST_temp.C_T = C_T_base;
	EST_temp.Q_in = Q;
	EST_temp.t_in = t;
		
	EST(j) = P_0_iteration(EST_temp,0,'Wk3');
	
	plot(t,EST(j).Pressure,'--')
end

figure, hold on, title('R_T')
plot(t,P,'k')
for j = 1:length(R_T)
	EST_temp.P_out = P_out_base;
	EST_temp.P_0 = DBP;
	EST_temp.R_T = R_T(j);
	EST_temp.Z_0 = Z_0_base;
	EST_temp.C_T = C_T_base;
	EST_temp.Q_in = Q;
	EST_temp.t_in = t;
		
	EST(j) = P_0_iteration(EST_temp,0,'Wk3');
	
	plot(t,EST(j).Pressure,'--')
end

figure, hold on, title('C_T')
plot(t,P,'k')
for j = 1:length(R_T)
	EST_temp.P_out = P_out_base;
	EST_temp.P_0 = DBP;
	EST_temp.R_T = R_T_base;
	EST_temp.Z_0 = Z_0_base;
	EST_temp.C_T = C_T(j);
	EST_temp.Q_in = Q;
	EST_temp.t_in = t;
		
	EST(j) = P_0_iteration(EST_temp,0,'Wk3');
	
	plot(t,EST(j).Pressure,'--')
end


%%	Iterate for each parameter and introduce physical relationships
figure, hold on, title('P_{out}')
plot(t,P,'k')
for j = 1:length(P_out)
	EST_temp.P_out = P_out(j);
	EST_temp.P_0 = DBP;
	EST_temp.R_T = (MBP - P_out(j)) / Q_mean;	%R_T changes with P_out
	EST_temp.Z_0 = Z_0_base;
	EST_temp.C_T = C_T_base;
	EST_temp.Q_in = Q;
	EST_temp.t_in = t;
		
	EST(j) = P_0_iteration(EST_temp,0,'Wk3');
	
	plot(t,EST(j).Pressure,'--')
end

figure, hold on, title('Z_0')
plot(t,P,'k')
for j = 1:length(Z_0)
	EST_temp.P_out = MBP - (Z_0(j) + R_2_base)*Q_mean;	%P_out changes with R_T
	EST_temp.P_0 = DBP;
	EST_temp.R_T = Z_0(j) + R_2_base;	%R_T changes with Z_0 to keep R_2 constant
	EST_temp.Z_0 = Z_0(j);
	EST_temp.C_T = C_T_base;
	EST_temp.Q_in = Q;
	EST_temp.t_in = t;
		
	EST(j) = P_0_iteration(EST_temp,0,'Wk3');
	
	mean(EST(j).Pressure)
	
	plot(t,EST(j).Pressure,'--')
end

figure, hold on, title('R_T')
plot(t,P,'k')
for j = 1:length(R_T)
	EST_temp.P_out = MBP - R_T(j)*Q_mean;	%P_out changes with R_T to keep MBP constant
% 	EST_temp.P_out = P_out_base;
	EST_temp.P_0 = DBP;
	EST_temp.R_T = R_T(j);
	EST_temp.Z_0 = Z_0_base;
	EST_temp.C_T = tau_base/(R_T(j)-Z_0_base);	%C_T changes with R_T to keep tau constant
	EST_temp.Q_in = Q;
	EST_temp.t_in = t;
		
	EST(j) = P_0_iteration(EST_temp,0,'Wk3');
	
	plot(t,EST(j).Pressure,'--')
end

% figure, hold on, title('C_T')
% plot(t,P,'k')
% for j = 1:length(C_T)
% 	EST_temp.P_out = P_out_base;
% 	EST_temp.P_0 = DBP;
% 	EST_temp.R_T = R_T_base;
% 	EST_temp.Z_0 = Z_0_base;
% 	EST_temp.C_T = C_T(j);
% 	EST_temp.Q_in = Q;
% 	EST_temp.t_in = t;
% 		
% 	EST(j) = P_0_iteration(EST_temp,0,'Wk3');
% 	
% 	plot(t,EST(j).Pressure,'--')
% end

